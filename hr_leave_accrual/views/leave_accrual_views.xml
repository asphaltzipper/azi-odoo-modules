<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="leave_type_view_form" model="ir.ui.view">
        <field name="name">leave.type.view.form</field>
        <field name="model">leave.type</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="leave_unit"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record id="leave_type_view_tree" model="ir.ui.view">
        <field name="name">leave.type.view.tree</field>
        <field name="model">leave.type</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="leave_unit"/>
            </tree>
        </field>
    </record>

    <record id="action_leave_type_tree" model="ir.actions.act_window">
        <field name="name">Leave Types</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">leave.type</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="leave_policy_assign_view_form" model="ir.ui.view">
        <field name="name">leave.policy_assign.view.form</field>
        <field name="model">leave.policy.assign</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="generate_allocation" type="object" string="Generate Allocations" class="btn-primary"/>
                </header>
                <sheet>
                    <group>
                        <field name="employee_id"/>
                        <field name="policy_id"/>
                        <field name="start_date"/>
                        <field name="end_date"/>
                    </group>
                    <notebook>
                        <page string="Generated Allocations">
                            <field name="policy_line_ids">
                                <tree create="false" delete="false" editable="top">
                                    <field name="year_char" readonly="1"/>
                                    <field name="start_date" readonly="1"/>
                                    <field name="end_date" readonly="1"/>
                                    <field name="balance"/>
                                    <field name="adjust"/>
                                    <field name="leave_allocation_ids" invisible="1" readonly="1" widget="many2many_tags"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="year_char"/>
                                                <field name="start_date"/>
                                                <field name="end_date"/>
                                            </group>
                                            <group>
                                                <field name="balance"/>
                                                <field name="adjust"/>
                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <record id="leave_policy_assign_view_tree" model="ir.ui.view">
        <field name="name">leave.policy_assign.view.tree</field>
        <field name="model">leave.policy.assign</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
                <field name="policy_id"/>
                <field name="start_date"/>
                <field name="end_date"/>
            </tree>
        </field>
    </record>
    <record id='leave_policy_assign_view_search' model='ir.ui.view'>
        <field name="name">leave.policy.assign.view.search</field>
        <field name="model">leave.policy.assign</field>
        <field name="arch" type="xml">
            <search>
                <field name="policy_id" />
                <group expand="1" string="Group By">
                    <filter name="group_policy" context="{'group_by' : 'policy_id'}" string="Policy"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_leave_policy_assign_tree" model="ir.actions.act_window">
        <field name="name">Assign Policy</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">leave.policy.assign</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="leave_accrual_policy_view_form" model="ir.ui.view">
        <field name="name">leave.accrual.policy.view.form</field>
        <field name="model">leave.accrual.policy</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="action" name="%(action_leave_policy_assign_tree)d"
                                icon="fa-book" context="{'default_policy_id': active_id,
                                'search_default_policy_id':active_id}">
                            <field string="Assigned Policies" name="policy_count" widget="statinfo"/>
                        </button>
                    </div>
                    <group>
                        <field name="name"/>
                        <field name="type_id"/>
                        <field name="rate"/>
                        <field name="rate_unit"/>
                        <field name="period_duration"/>
                        <field name="period_unit"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record id="leave_accrual_policy_view_tree" model="ir.ui.view">
        <field name="name">leave.accrual.policy.view.tree</field>
        <field name="model">leave.accrual.policy</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="type_id"/>
                <field name="rate"/>
                <field name="rate_unit"/>
                <field name="period_duration"/>
                <field name="period_unit"/>
            </tree>
        </field>
    </record>

    <record id="action_leave_accrual_policy_tree" model="ir.actions.act_window">
        <field name="name">Accrual Policies</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">leave.accrual.policy</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="leave_allocation_view_form" model="ir.ui.view">
        <field name="name">leave.allocation.view.form</field>
        <field name="model">leave.allocation</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="employee_id"/>
                        <field name="type_id"/>
                        <field name="alloc_amount" required="1"/>
                        <field name="alloc_unit"/>
                        <field name="start_date"/>
                        <field name="end_date"/>
                        <field name="allocation_type"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    <record id="leave_allocation_view_tree" model="ir.ui.view">
        <field name="name">leave.allocation.view.tree</field>
        <field name="model">leave.allocation</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
                <field name="type_id"/>
                <field name="alloc_unit"/>
                <field name="start_date"/>
                <field name="end_date"/>
            </tree>
        </field>
    </record>

    <record id="action_leave_allocation_tree" model="ir.actions.act_window">
        <field name="name">Allocations</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">leave.allocation</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="leave_accrual_avail_view_tree" model="ir.ui.view">
        <field name="name">leave.accrual.avail.tree</field>
        <field name="model">leave.accrual.avail</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
                <field name="type_id"/>
                <field name="amount"/>
                <field name="unit"/>
            </tree>
        </field>
    </record>
    <record id="leave_accrual_allocated_tree" model="ir.ui.view">
        <field name="name">leave.accrual.allocated.tree</field>
        <field name="model">leave.accrual.allocated</field>
        <field name="arch" type="xml">
            <tree>
                <field name="employee_id"/>
                <field name="type_id"/>
                <field name="unit"/>
                <field name="opening_balance"/>
                <field name="adjust"/>
                <field name="allocated_amount"/>
                <field name="used_amount"/>
                <field name="adjusted_amount"/>
                <field name="balance"/>
            </tree>
        </field>
    </record>
    <record id="leave_accrual_allocated_action" model="ir.actions.act_window">
        <field name="name">Allocations Summary</field>
        <field name="res_model">leave.accrual.allocated</field>
        <field name="view_mode">tree</field>
    </record>

    <menuitem id="leave_menu"
        name="Leaves"
        groups="hr.group_hr_manager"
        sequence="45"
        web_icon="hr_leave_accrual,static/description/icon.png"/>

    <menuitem id="leave_operations_menu"
        name="Operations"
        parent="hr_leave_accrual.leave_menu"
        sequence="10"/>

    <menuitem id="leave_allocations_menu"
        name="Allocations"
        parent="hr_leave_accrual.leave_operations_menu"
        action="action_leave_allocation_tree"
        sequence="10"/>

    <menuitem id="leave_assignments_menu"
        name="Employee Policies"
        parent="hr_leave_accrual.leave_operations_menu"
        action="action_leave_policy_assign_tree"
        sequence="20"/>

    <menuitem id="leave_config_menu"
        name="Configuration"
        parent="hr_leave_accrual.leave_menu"
        sequence="20"/>

    <menuitem id="leave_type_menu"
        name="Leave Types"
        parent="hr_leave_accrual.leave_config_menu"
        action="action_leave_type_tree"
        sequence="10"/>

    <menuitem id="leave_policy_menu"
        name="Accrual Policies"
        parent="hr_leave_accrual.leave_config_menu"
        action="action_leave_accrual_policy_tree"
        sequence="20"/>

    <menuitem id="leave_accrual_allocated_menu"
        parent="hr_leave_accrual.leave_operations_menu"
        action="leave_accrual_allocated_action"
        sequence="30"/>
</odoo>
